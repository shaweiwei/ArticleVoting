# ArticleVoting
redis-test -spring
1.1.1　对文章进行投票
需求设计
有趣的文章：一篇文章获得了至少200张支持票（upvote）。
每天的TOP100文章：假如这个网站每天发布1000篇文章，而其中的50篇符合网站对有趣文章的要求，那么网站要做的就是把这50篇文章放到文章列表前100位至少一天。
文章的评分随着时间流逝而不断减少：程序根据文章的发布时间和当前时间来计算文章的评分，具体的计算方法为：将文章得到的支持票数量乘以一个常数，然后加上文章的发布时间，得出的结果就是文章的评分。
另外，常量为432，这个常量是通过将一天的秒数（86400）除以文章展示一天所需的支持票数量（200）得出的：文章每获得一张支持票，程序就需要将文章的评分增加432分。

文章信息存储：用一个散列来存储文章的标题、指向文章的网址、发布文章的用户、文章的发布时间、文章得到的投票数量等信息。


使用冒号作为分隔符：里面的键名article:92617就使用了冒号来分隔单词article和文章的ID号92617，以此来构建命名空间（namespace）。

使用两个有序集合来有序地存储文章：
第一个有序集合的成员为文章ID，分值为文章的发布时间；
第二个有序集合的成员同样为文章ID，而分值则为文章的评分。
通过这两个有序集合，网站既可以根据文章发布的先后顺序来展示文章，又可以根据文章评分的高低来展示文章。


单篇文章防重复投票，网站需要为每篇文章记录一个已投票用户名单。为此，程序将为每篇文章创建一个集合，并使用这个集合来存储所有已投票用户的ID。


为了尽量节约内存，我们规定当一篇文章发布期满一周之后，用户将不能再对它进行投票，文章的评分将被固定下来，而记录文章已投票用户名单的集合也会被删除。


既然我们已经知道了网站计算文章评分的方法，也知道了网站存储数据所需的数据结构，那么现在是时候实际地实现这个投票功能了！当用户尝试对一篇文章进行投票时，程序需要使用ZSCORE命令检查记录文章发布时间的有序集合，判断文章的发布时间是否未超过一周。如果文章仍然处于可以投票的时间范围之内，那么程序将使用SADD命令，尝试将用户添加到记录文章已投票用户名单的集合里面。如果添加操作执行成功的话，那么说明用户是第一次对这篇文章进行投票，程序将使用ZINCRBY命令为文章的评分增加432分（ZINCRBY``命令用于对有序集合成员的分值执行自增操作），并使用HINCRBY命令对散列记录的文章投票数量进行更新（HINCRBY``命令用于对散列存储的值执行自增操作）。
